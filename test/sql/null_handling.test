# name: test/sql/null_handling.test
# description: NULL propagation and division by zero
# group: [thdck_spark_funcs]

require thdck_spark_funcs

# NULL dividend -> NULL
query I
SELECT spark_decimal_div(NULL::DECIMAL(4,2), 3.0::DECIMAL(3,1));
----
NULL

# NULL divisor -> NULL
query I
SELECT spark_decimal_div(10.00::DECIMAL(4,2), NULL::DECIMAL(3,1));
----
NULL

# Both NULL -> NULL
query I
SELECT spark_decimal_div(NULL::DECIMAL(4,2), NULL::DECIMAL(3,1));
----
NULL

# Division by zero -> NULL
query I
SELECT spark_decimal_div(10.00::DECIMAL(4,2), 0.0::DECIMAL(3,1));
----
NULL

# Division of zero by nonzero -> 0
query I
SELECT spark_decimal_div(0.00::DECIMAL(4,2), 3.0::DECIMAL(3,1));
----
0.000000
